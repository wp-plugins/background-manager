/*
 * Copyright (c) 2011-2012 Mike Green <myatus@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 *
 */
(function(a){a.extend(myatu_bgm,{showHideLayoutTable:function(b){if((typeof b==="string"&&b=="full")||this.value=="full"){a(".bg_extra_layout").hide();a(".bg_fs_layout").show("slow");myatu_bgm.updateOpacity()}else{a(".bg_fs_layout").hide();a(".bg_extra_layout").show("slow");myatu_bgm.updateOpacity(100)}},showHideInfoExtra:function(){if(a("#info_tab:checked").length){a(".info_tab_extra").show("slow")}else{a(".info_tab_extra").hide("slow")}},updatePreviewColor:function(){var b=a("#background_color").val();if(b&&b.charAt(0)=="#"){if(b.length>1){a("#bg_preview_bg_color").css("background-color",b);a("#clear_color").show()}else{a("#bg_preview_bg_color").css("background-color","");a("#clear_color").hide()}}},updateOpacity:function(d){var c=a("#background_opacity").val(),b="100";if(d){c=d}if(c<10){b=".0"+c}else{if(c<100){b="."+c}}a("#bg_preview").css("opacity",b)},updatePreviewOverlay:function(){var b=myatu_bgm.GetAjaxData("overlay_data",a("#active_overlay option:selected").val());if(b){a("#bg_preview_overlay").css("background","url('"+b+"') repeat fixed top left transparent")}else{a("#bg_preview_overlay").css("background","")}},updatePreviewGallery:function(){var c=a("#active_gallery option:selected").val(),b=myatu_bgm.GetAjaxData("random_image",{active_gallery:c,prev_img:"none"});if(b){a("#bg_preview").css("background-image","url('"+b.thumb+"')")}else{a("#bg_preview").css("background-image","")}},updatePreviewLayout:function(){var f=a('input[name="background_size"]:checked').val(),c=a('input[name="background_position"]:checked').val().replace("-"," "),e=a('input[name="background_repeat"]:checked').val(),d=(a("#background_stretch_horizontal:checked").length==1),b=(a("#background_stretch_vertical:checked").length==1);if(f=="full"){a("#bg_preview").css({"background-size":"100% auto","background-repeat":"no-repeat","background-position":"50% 50%",})}else{a("#bg_preview").css({"background-size":((d)?"100%":"50px")+" "+((b)?"100%":"50px"),"background-repeat":e,"background-position":c,})}},clearColor:function(){a("#background_color").val("#");myatu_bgm.updatePreviewColor();return false}});a(document).ready(function(b){myatu_bgm.updatePreviewColor();myatu_bgm.updatePreviewGallery();myatu_bgm.updateOpacity();myatu_bgm.updatePreviewLayout();myatu_bgm.updatePreviewOverlay();myatu_bgm.showHideInfoExtra();myatu_bgm.showHideLayoutTable(b('input[name="background_size"]:checked').val());b("#background_color").focusin(function(){b("#color_picker").show()}).focusout(function(){b("#color_picker").hide();myatu_bgm.updatePreviewColor()}).keyup(function(){if(this.value.charAt(0)!="#"){this.value="#"+this.value}b.farbtastic("#color_picker").setColor(b("#background_color").val());myatu_bgm.updatePreviewColor()});b("#color_picker").farbtastic(function(c){b("#background_color").attr("value",c);myatu_bgm.updatePreviewColor()});b.farbtastic("#color_picker").setColor(b("#background_color").val());b("#opacity_picker").slider({value:b("#background_opacity").val(),min:1,max:100,slide:function(c,d){b("#background_opacity").val(d.value);b("#opacity_picker_val").text(d.value+"%");myatu_bgm.updateOpacity()}});b('input[name="background_size"]').change(myatu_bgm.showHideLayoutTable);b("#active_gallery").change(myatu_bgm.updatePreviewGallery);b("#active_overlay").change(myatu_bgm.updatePreviewOverlay);b('input[name="background_size"]').change(myatu_bgm.updatePreviewLayout);b('input[name="background_position"]').change(myatu_bgm.updatePreviewLayout);b('input[name="background_repeat"]').change(myatu_bgm.updatePreviewLayout);b("#background_stretch_horizontal").click(myatu_bgm.updatePreviewLayout);b("#background_stretch_vertical").click(myatu_bgm.updatePreviewLayout);b("#info_tab").click(myatu_bgm.showHideInfoExtra);b("#clear_color").click(myatu_bgm.clearColor);b("#footer_debug_link").click(function(){b("#footer_debug").toggle();return false})})})(jQuery);
